<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ููุตุฉ ุงูุชุนุฏูู ุงูุชููุงุฆู</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
</head>
<body>
    <div class="container-fluid">
        <!-- Header Section -->
        <div class="header-section">
            <div class="row align-items-center">
                <div class="col-12">
                    <div class="user-info-card">
                        <h2 class="text-center mb-3">
                            <i class="fas fa-coins text-warning"></i>
                            ููุตุฉ ุงูุชุนุฏูู ุงูุชููุงุฆู
                        </h2>

                        <!-- User IP and Location -->
                        <div class="ip-info">
                            <div class="row">
                                <div class="col-md-6">
                            <div class="info-item">
                                <i class="fas fa-network-wired text-primary"></i>
                                <strong>ุนููุงู IP:</strong> {{ user_ip }}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="info-item">
                                <i class="fas fa-fingerprint text-warning"></i>
                                <strong>ูุนุฑู ุงูุฌูุณุฉ:</strong> 
                                <span class="badge bg-secondary">{{ session.user_id[:8] if session.user_id else 'ุบูุฑ ูุญุฏุฏ' }}...</span>
                            </div>
                        </div>
                                <div class="col-md-6">
                                    <div class="info-item">
                                        <i class="fas fa-map-marker-alt text-success"></i>
                                        <strong>ุงูุจูุฏ:</strong> 
                                        <img src="https://flagcdn.com/24x18/{{ user_location.flag }}.png" alt="Flag" class="flag-icon">
                                        {{ user_location.country }}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- User Agent Detection -->
                        <div class="user-agent-section" id="userAgentSection">
                            <div class="alert alert-info">
                                <strong>ุฌูุงุฒู:</strong> <span id="deviceInfo"></span>
                                <button class="btn btn-sm btn-outline-primary me-2" onclick="toggleUserAgent()">
                                    <span id="uaToggleText">ุนุฑุถ ุงูุชูุงุตูู</span>
                                </button>
                            </div>
                            <div id="userAgentDetails" style="display: none;">
                                <small class="text-muted">{{ user_agent }}</small>
                                <div class="mt-2">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="useCustomUA">
                                        <label class="form-check-label" for="useCustomUA">
                                            ุงุณุชุฎุฏุงู User-Agent ุงููุฎุตุต ุงูุฎุงุต ุจู ูู ุงูุทูุจุงุช
                                        </label>
                                    </div>
                                    <small class="text-muted">
                                        ุชูุนูู ูุฐุง ุงูุฎูุงุฑ ุณูุณุชุฎุฏู ูุนูููุงุช ุฌูุงุฒู ุงูุญููููุฉ ูู ุทูุจุงุช ุงูุชุนุฏูู
                                    </small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mining Status Section -->
        <div class="operation-status-section mb-4">
            <h3 class="text-center mb-4">
                <i class="fas fa-chart-line"></i>
                ุญุงูุฉ ุงูุนูููุงุช ุงููุณุชูุฑุฉ
            </h3>
            <div class="alert alert-info text-center">
                <i class="fas fa-info-circle"></i>
                ุงููุธุงู ูุนูู ุจุดูู ูุณุชูุฑ - ูุจุญุซ ุนู ููุงู ุฌุฏูุฏุฉ ูู ุฏูููุฉ
            </div>
            <div class="row">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="fas fa-list"></i>
                                ุณุฌู ุงูุนูููุงุช ุงููุจุงุดุฑ
                            </h5>
                        </div>
                        <div class="card-body">
                            <div id="operationLogs" class="operation-logs">
                                <p class="text-muted">ุฌุงุฑู ุชุญููู ุณุฌู ุงูุนูููุงุช...</p>
                            </div>
                            <div class="text-center mt-3">
                                <button class="btn btn-outline-danger btn-sm" onclick="clearOperationLogs()">
                                    <i class="fas fa-trash"></i>
                                    ูุณุญ ุงูุณุฌู
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mining Buttons Section -->
        <div class="mining-section">
            <h3 class="text-center mb-4">
                <i class="fas fa-pickaxe"></i>
                ุฃููุงุน ุงูุชุนุฏูู ุงููุชุงุญุฉ
            </h3>

            <div class="row g-3">
                <!-- COIN Mining -->
                <div class="col-md-6">
                    <div class="mining-card">
                        <div class="mining-header">
                            <span class="mining-emoji">๐ช</span>
                            <h5>COIN</h5>
                            <span class="status-badge" id="coinStatus">ูุชููู</span>
                        </div>
                        <p class="mining-description">{{ custom_links.coin.description }}</p>
                        <div class="mining-controls">
                            <input type="url" class="form-control mb-2" id="coinUrl" 
                                   placeholder="ุถุน ุฑุงุจุท ุงูุชุนุฏูู ููุง...">
                            <div class="btn-group w-100">
                                <button class="btn btn-success" onclick="startMining('COIN')">
                                    <i class="fas fa-play"></i> ุจุฏุก ุงูุชุนุฏูู
                                </button>
                                <button class="btn btn-danger" onclick="stopMining('COIN')">
                                    <i class="fas fa-stop"></i> ุฅููุงู
                                </button>
                            </div>
                        </div>
                        <div class="mining-stats">
                            <small>ุงูููุงู ุงูููุชููุฉ: <span id="coinTasks">{{ user_stats.mining_types.COIN or 0 }}</span></small>
                        </div>
                    </div>
                </div>

                <!-- BANAN Mining -->
                <div class="col-md-6">
                    <div class="mining-card">
                        <div class="mining-header">
                            <span class="mining-emoji">๐</span>
                            <h5>BANAN</h5>
                            <span class="status-badge" id="bananStatus">ูุชููู</span>
                        </div>
                        <p class="mining-description">{{ custom_links.banan.description }}</p>
                        <div class="mining-controls">
                            <input type="url" class="form-control mb-2" id="bananUrl" 
                                   placeholder="ุถุน ุฑุงุจุท ุงูุชุนุฏูู ููุง...">
                            <div class="btn-group w-100">
                                <button class="btn btn-success" onclick="startMining('BANAN')">
                                    <i class="fas fa-play"></i> ุจุฏุก ุงูุชุนุฏูู
                                </button>
                                <button class="btn btn-danger" onclick="stopMining('BANAN')">
                                    <i class="fas fa-stop"></i> ุฅููุงู
                                </button>
                            </div>
                        </div>
                        <div class="mining-stats">
                            <small>ุงูููุงู ุงูููุชููุฉ: <span id="bananTasks">{{ user_stats.mining_types.BANAN or 0 }}</span></small>
                        </div>
                    </div>
                </div>

                <!-- TRX Mining -->
                <div class="col-md-6">
                    <div class="mining-card">
                        <div class="mining-header">
                            <span class="mining-emoji">๐</span>
                            <h5>TRX</h5>
                            <span class="status-badge" id="trxStatus">ูุชููู</span>
                        </div>
                        <p class="mining-description">{{ custom_links.trx.description }}</p>
                        <div class="mining-controls">
                            <input type="url" class="form-control mb-2" id="trxUrl" 
                                   placeholder="ุถุน ุฑุงุจุท ุงูุชุนุฏูู ููุง...">
                            <div class="btn-group w-100">
                                <button class="btn btn-success" onclick="startMining('TRX')">
                                    <i class="fas fa-play"></i> ุจุฏุก ุงูุชุนุฏูู
                                </button>
                                <button class="btn btn-danger" onclick="stopMining('TRX')">
                                    <i class="fas fa-stop"></i> ุฅููุงู
                                </button>
                            </div>
                        </div>
                        <div class="mining-stats">
                            <small>ุงูููุงู ุงูููุชููุฉ: <span id="trxTasks">{{ user_stats.mining_types.TRX or 0 }}</span></small>
                        </div>
                    </div>
                </div>

                <!-- SHIB Mining -->
                <div class="col-md-6">
                    <div class="mining-card">
                        <div class="mining-header">
                            <span class="mining-emoji">๐</span>
                            <h5>SHIB</h5>
                            <span class="status-badge" id="shibStatus">ูุชููู</span>
                        </div>
                        <p class="mining-description">{{ custom_links.shib.description }}</p>
                        <div class="mining-controls">
                            <input type="url" class="form-control mb-2" id="shibUrl" 
                                   placeholder="ุถุน ุฑุงุจุท ุงูุชุนุฏูู ููุง...">
                            <div class="btn-group w-100">
                                <button class="btn btn-success" onclick="startMining('SHIB')">
                                    <i class="fas fa-play"></i> ุจุฏุก ุงูุชุนุฏูู
                                </button>
                                <button class="btn btn-danger" onclick="stopMining('SHIB')">
                                    <i class="fas fa-stop"></i> ุฅููุงู
                                </button>
                            </div>
                        </div>
                        <div class="mining-stats">
                            <small>ุงูููุงู ุงูููุชููุฉ: <span id="shibTasks">{{ user_stats.mining_types.SHIB or 0 }}</span></small>
                        </div>
                    </div>
                </div>

                <!-- BEAMX Mining -->
                <div class="col-md-6">
                    <div class="mining-card">
                        <div class="mining-header">
                            <span class="mining-emoji">โก</span>
                            <h5>BEAMX</h5>
                            <span class="status-badge" id="beamxStatus">ูุชููู</span>
                        </div>
                        <p class="mining-description">{{ custom_links.beamx.description }}</p>
                        <div class="mining-controls">
                            <input type="url" class="form-control mb-2" id="beamxUrl" 
                                   placeholder="ุถุน ุฑุงุจุท ุงูุชุนุฏูู ููุง...">
                            <div class="btn-group w-100">
                                <button class="btn btn-success" onclick="startMining('BEAMX')">
                                    <i class="fas fa-play"></i> ุจุฏุก ุงูุชุนุฏูู
                                </button>
                                <button class="btn btn-danger" onclick="stopMining('BEAMX')">
                                    <i class="fas fa-stop"></i> ุฅููุงู
                                </button>
                            </div>
                        </div>
                        <div class="mining-stats">
                            <small>ุงูููุงู ุงูููุชููุฉ: <span id="beamxTasks">{{ user_stats.mining_types.BEAMX or 0 }}</span></small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions mt-4">
                <div class="row">
                    <div class="col-md-6">
                        <button class="btn btn-danger btn-lg w-100" onclick="stopAllMining()">
                            <i class="fas fa-stop-circle"></i>
                            ุฅููุงู ุฌููุน ุฃููุงุน ุงูุชุนุฏูู
                        </button>
                    </div>
                    <div class="col-md-6">
                        <a href="{{ url_for('donations') }}" class="btn btn-warning btn-lg w-100">
                            <i class="fas fa-heart"></i>
                            ุตูุญุฉ ุงูุชุจุฑุนุงุช
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Statistics Section -->
        <div class="stats-section">
            <h3 class="text-center mb-4">
                <i class="fas fa-chart-bar"></i>
                ุฅุญุตุงุฆูุงุชู
            </h3>

            <div class="row">
                <div class="col-md-4">
                    <div class="stat-card">
                        <div class="stat-number">{{ user_stats.total_tasks }}</div>
                        <div class="stat-label">ุฅุฌูุงูู ุงูููุงู</div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="stat-card">
                        <div class="stat-number" id="activeMining">0</div>
                        <div class="stat-label">ุงูุชุนุฏูู ุงููุดุท</div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="stat-card">
                        <div class="stat-number">{{ user_stats.start_date[:10] if user_stats.start_date else 'ุงูููู' }}</div>
                        <div class="stat-label">ุชุงุฑูุฎ ุงูุจุฏุงูุฉ</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- URL History Section -->
        <div class="url-history-section">
            <h3 class="text-center mb-4">
                <i class="fas fa-history"></i>
                ุณุฌู ุงูุฑูุงุจุท ุงููุญููุธุฉ
            </h3>

            <div class="history-controls text-center mb-3">
                <button class="btn btn-info" onclick="loadUrlHistory()">
                    <i class="fas fa-reload"></i>
                    ุชุญุฏูุซ ุงูุณุฌู
                </button>
                <button class="btn btn-warning" onclick="clearUrlHistory()">
                    <i class="fas fa-trash"></i>
                    ูุณุญ ุงูุณุฌู
                </button>
            </div>

            <div id="urlHistoryContainer" style="display: none;">
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>ููุน ุงูุชุนุฏูู</th>
                                <th>ุงูุชุงุฑูุฎ</th>
                                <th>ุงูุญุงูุฉ</th>
                                <th>ุงูุฅุฌุฑุงุกุงุช</th>
                            </tr>
                        </thead>
                        <tbody id="urlHistoryTable">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Operation Logs Section -->
        <div class="operation-logs-section">
            <h3 class="text-center mb-4">
                <i class="fas fa-cogs"></i>
                ุณุฌู ุงูุนูููุงุช ุงูุชูุตููู
            </h3>

            <div class="logs-controls text-center mb-3">
                <button class="btn btn-success" onclick="loadOperationLogs()">
                    <i class="fas fa-sync"></i>
                    ุชุญุฏูุซ ุงูุณุฌู
                </button>
                <button class="btn btn-danger" onclick="clearOperationLogs()">
                    <i class="fas fa-trash-alt"></i>
                    ูุณุญ ุงูุณุฌู
                </button>
                <button class="btn btn-info" onclick="toggleAutoRefresh()">
                    <i class="fas fa-play" id="autoRefreshIcon"></i>
                    <span id="autoRefreshText">ุชูุนูู ุงูุชุญุฏูุซ ุงูุชููุงุฆู</span>
                </button>
            </div>

            <div id="operationLogsContainer">
                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead class="table-dark">
                            <tr>
                                <th>ุงูููุช</th>
                                <th>ููุน ุงูุชุนุฏูู</th>
                                <th>ุงูุฎุทูุฉ</th>
                                <th>ุงูุญุงูุฉ</th>
                                <th>ุงูุชูุงุตูู</th>
                            </tr>
                        </thead>
                        <tbody id="operationLogsTable">
                            <tr>
                                <td colspan="5" class="text-center text-muted">
                                    <i class="fas fa-info-circle"></i>
                                    ูุง ุชูุฌุฏ ุนูููุงุช ูุณุฌูุฉ ุจุนุฏ
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Admin Panel -->
        {% if is_admin %}
        <div class="admin-section">
            <h3 class="text-center mb-4">
                <i class="fas fa-user-shield text-danger"></i>
                ููุญุฉ ุงูุฃุฏูู
            </h3>

            <div class="admin-controls">
                <button class="btn btn-info mb-3" onclick="loadUsers()">
                    <i class="fas fa-users"></i>
                    ุนุฑุถ ุฌููุน ุงููุณุชุฎุฏููู
                </button>

                <div id="usersContainer" style="display: none;">
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>ูุนุฑู ุงููุณุชุฎุฏู</th>
                                    <th>ุฅุฌูุงูู ุงูููุงู</th>
                                    <th>ุงูุชุนุฏูู ุงููุดุท</th>
                                    <th>ุงูุฅุฌุฑุงุกุงุช</th>
                                </tr>
                            </thead>
                            <tbody id="usersTable">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- ุญุงูุฉ ุงูุฅุนูุงูุงุช ุงูููููุฉ -->
        <div class="section-card mt-4">
            <h3 class="section-title">
                <i class="fas fa-chart-bar"></i>
                ุญุงูุฉ ุงูุฅุนูุงูุงุช ุงูููููุฉ
            </h3>
            <div class="daily-ads-container">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <button class="btn btn-primary btn-sm" onclick="refreshDailyAdsStatus()">
                        <i class="fas fa-sync-alt"></i> ุชุญุฏูุซ ุงูุญุงูุฉ
                    </button>
                    <small class="text-muted">ุขุฎุฑ ุชุญุฏูุซ: <span id="lastUpdateTime">ุบูุฑ ูุญุฏุฏ</span></small>
                </div>
                <div id="dailyAdsStatus" class="row">
                    <div class="text-center text-muted">
                        <i class="fas fa-spinner fa-spin"></i>
                        ุฌุงุฑู ุชุญููู ุงูุจูุงูุงุช...
                    </div>
                </div>
            </div>
        </div>

        <!-- ูุนูููุงุช ุงูุนูููุงุช -->
        <div class="section-card mt-4">
            <h3 class="section-title">
                <i class="fas fa-info-circle"></i>
                ุณุฌู ุงูุนูููุงุช
            </h3>
            <div class="operation-logs-container">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <button class="btn btn-primary btn-sm" onclick="refreshOperationLogs()">
                        <i class="fas fa-sync-alt"></i> ุชุญุฏูุซ
                    </button>
                    <button class="btn btn-danger btn-sm" onclick="clearOperationLogs()">
                        <i class="fas fa-trash"></i> ูุณุญ ุงูุณุฌู
                    </button>
                </div>
                <div id="operationLogs" class="operation-logs">
                    <div class="text-center text-muted">
                        <i class="fas fa-spinner fa-spin"></i>
                        ุฌุงุฑู ุชุญููู ุงูุณุฌู...
                    </div>
                </div>
            </div>
        </div>


    </div>

    <!-- Toast Notifications -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3">
        <div id="notificationToast" class="toast" role="alert">
            <div class="toast-header">
                <strong class="me-auto">ุฅุดุนุงุฑ</strong>
                <button type="button" class="btn-close" data-bs-dismiss="toast"></button>
            </div>v>
            <div class="toast-body" id="toastMessage">
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>

    <script>
        // ุชุญุฏูุฏ ูุนูููุงุช ุงูุฌูุงุฒ
        document.addEventListener('DOMContentLoaded', function() {
            detectDevice();
            updateMiningStatus();

            // ุชุญุฏูุซ ุงูุญุงูุฉ ูู 30 ุซุงููุฉ
            setInterval(updateMiningStatus, 30000);
        });
    </script>
</body>
</html>
